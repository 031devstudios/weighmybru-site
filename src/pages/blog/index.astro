---
import { getCollection } from 'astro:content';
import BaseHead from '../../components/BaseHead.astro';
import Footer from '../../components/sections/Footer.astro';
import Header from '../../components/sections/Header.astro';
import BlogHero from '../../components/sections/BlogHero.astro';
import BlogAllArticles from '../../components/sections/BlogAllArticles.astro';
import BlogPagination from '../../components/ui/nav/BlogPagination.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../../consts';

const PAGE_SIZE = 6;
const posts = (await getCollection('blog')).sort((a,b)=>+b.data.pubDate-+a.data.pubDate);
const firstPagePosts = posts.slice(0, PAGE_SIZE);
const totalPages = Math.max(1, Math.ceil(posts.length / PAGE_SIZE));
---

<!doctype html>
<html lang="en" data-theme="dark" class="dark">
	<head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
    {totalPages > 1 && (
      <link rel="next" href={`/blog/page/2/`} />
    )}
	</head>
	<body>
        <Header />
        <BlogHero title="Guides" subtitle="Step-by-step tutorials for building, flashing, troubleshooting, and getting the most from your WeighMyBru scale." />
        <main class="use-utility-layout mx-auto max-w-5xl px-3 py-5 space-y-7">
            <BlogAllArticles posts={firstPagePosts} />
            <BlogPagination currentPage={1} totalPages={totalPages} />
        </main>
        <Footer />
	</body>
</html>
